# US-08: Xem giỏ hàng và tổng tiền

## Bối cảnh
- Epic: Mua sắm & Giỏ hàng
- Vai trò: Người mua (User đã đăng nhập)
- Mục tiêu: Cho phép user xem danh sách sản phẩm đã thêm vào giỏ, điều chỉnh số lượng, và tiến hành đặt hàng.

## Phạm vi
- Trang giỏ hàng (`/cart`) hiển thị danh sách sản phẩm
- Cho phép tăng/giảm số lượng từng sản phẩm
- Cho phép xóa sản phẩm khỏi giỏ
- Hiển thị tổng tiền cập nhật theo thời gian thực
- Chức năng checkout (đặt hàng)

## Luồng chính (happy path)
- User truy cập `/cart` (hoặc bấm "Xem giỏ hàng" từ phòng thử đồ)
- Client gọi API `GET /api/cart` để lấy danh sách sản phẩm
- UI hiển thị:
    - Danh sách sản phẩm (ảnh, tên, giá, số lượng, subtotal)
    - Nút +/- để điều chỉnh số lượng
    - Nút xóa từng item
    - Tổng tiền giỏ hàng
- User bấm "Đặt hàng" → Hiển thị modal nhập địa chỉ giao hàng
- User điền thông tin và xác nhận → Client gọi API `POST /api/orders`
- Server tạo đơn hàng và clear giỏ
- UI hiển thị màn hình "Đặt hàng thành công!" với mã đơn

## Luồng lỗi cần xử lý
- Giỏ hàng trống: Hiển thị Empty State với nút "Đến phòng thử đồ"
- Sản phẩm đã bị xóa khỏi hệ thống: Load lại giỏ và thông báo
- Lỗi checkout: Giữ giỏ hàng và hiển thị thông báo lỗi
- User chưa đăng nhập: Redirect về login

## Dữ liệu & validate gợi ý
- Cart API Response: `{ items: [{product, quantity, subtotal}], totalItems, totalAmount }`
- Checkout Input: `{ shipping_address, shipping_phone, notes }`
- Quantity phải >= 1

## Acceptance Criteria
- Giỏ hàng hiển thị đầy đủ thông tin sản phẩm
- Thay đổi số lượng → Tổng tiền cập nhật ngay lập tức
- Xóa sản phẩm → Item biến mất khỏi danh sách
- Checkout thành công → Hiển thị thông báo với mã đơn hàng
- Sau checkout → Giỏ hàng trống
- Responsive trên mobile (stack layout)

## Phi chức năng
- UX: Loading state khi đang xử lý API
- UX: Confirm dialog trước khi xóa toàn bộ giỏ
- Performance: Tổng tiền tính toán phía client để cập nhật real-time
- SEO: Title page phù hợp ("Giỏ hàng - Try-on")
