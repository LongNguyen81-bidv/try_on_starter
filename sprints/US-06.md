# US-06: Chuyển đổi sản phẩm và tự động mặc thử (Navigation)

## Bối cảnh
- Epic: Phòng thử đồ (Virtual Fitting Room).
- Vai trò: Người mua.
- Mục tiêu: Dễ dàng xem mình mặc các bộ đồ khác nhau bằng thao tác đơn giản (bấm nút hoặc vuốt), giúp trải nghiệm mua sắm giống như đang thử đồ thật trước gương.

## Phạm vi
- Điều hướng qua lại giữa các sản phẩm trong danh sách (Next/Previous).
- Tự động trigger tính năng thử đồ (Try-on) khi đổi sản phẩm.
- Quản lý trạng thái chờ (Loading state) khi chuyển đổi.
- Cập nhật thông tin sản phẩm tương ứng (Tên, Giá).

## Luồng chính (happy path)
- User đang xem sản phẩm A.
- User bấm nút "Mũi tên phải" (hoặc vuốt sang trái trên mobile) để sang sản phẩm B.
- UI ngay lập tức cập nhật Tên, Giá của sản phẩm B.
- Khu vực hình ảnh hiện trạng thái Loading (Spinner hoặc hiệu ứng quét).
- Client ngầm gọi API `POST /api/try-on` cho sản phẩm B.
- Khi API trả về URL ảnh mới -> UI thay thế ảnh cũ bằng ảnh User mặc sản phẩm B -> Tắt Loading.

## Luồng lỗi cần xử lý
- User bấm chuyển quá nhanh (Spam click): Cần cơ chế Debounce (chỉ gửi request cuối cùng) hoặc Disable nút bấm trong lúc đang Loading để tránh lỗi chồng chéo request.
- Hết danh sách: Ẩn nút Next hoặc quay vòng lại sản phẩm đầu tiên (Loop).
- Lỗi tải ảnh: Nếu AI trả về lỗi cho sản phẩm B, giữ nguyên ảnh User gốc hoặc hiện placeholder lỗi, không để vỡ layout.

## Dữ liệu & validate gợi ý
- State Client: `currentIndex`, `isLoading`, `cachedImages` (Lưu tạm các URL đã load để khi user bấm Back không cần gọi lại API).

## Acceptance Criteria
- Bấm Next/Prev chuyển đúng thứ tự sản phẩm.
- Thông tin sản phẩm (Text) thay đổi ngay lập tức.
- Hình ảnh có trạng thái chờ rõ ràng (không bị giật cục).
- Nếu quay lại sản phẩm vừa xem (bấm Back), ảnh hiện ra ngay lập tức (không loading lâu) nhờ cơ chế Cache của Browser hoặc Client State.

## Phi chức năng
- UI/UX: Nút điều hướng phải dễ bấm trên Mobile (Thumb-friendly area).
- Hiệu ứng: Nên có transition nhẹ (fade in/out) khi thay đổi ảnh để trải nghiệm mượt mà hơn.